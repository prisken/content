{% extends "base.html" %}

{% block title %}Settings - Content Creator Pro{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-12">
            <h1 class="h2 mb-4">
                <i class="fas fa-cog me-2 text-primary"></i>Settings
            </h1>
        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-8">
            <!-- Profile Settings -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-user me-2"></i>Profile</h5>
                </div>
                <div class="card-body">
                    <form id="profileForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Name</label>
                                <input type="text" class="form-control" value="Demo User" id="userName">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" value="demo@contentcreator.com" readonly>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Company</label>
                                <input type="text" class="form-control" value="Content Creator Pro" id="userCompany">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Industry</label>
                                <select class="form-select" id="userIndustry">
                                    <option value="technology">Technology</option>
                                    <option value="finance">Finance</option>
                                    <option value="healthcare">Healthcare</option>
                                    <option value="education">Education</option>
                                    <option value="marketing">Marketing</option>
                                    <option value="consulting">Consulting</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Region</label>
                                <select class="form-select" id="userRegion">
                                    <option value="global">Global</option>
                                    <option value="us">United States</option>
                                    <option value="eu">Europe</option>
                                    <option value="asia">Asia</option>
                                    <option value="latin_america">Latin America</option>
                                    <option value="africa">Africa</option>
                                    <option value="oceania">Oceania</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Language</label>
                                <select class="form-select" id="userLanguage">
                                    <option value="en">English</option>
                                    <option value="zh">中文</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="ja">Japanese</option>
                                    <option value="ko">Korean</option>
                                </select>
                            </div>
                        </div>
                        <div class="text-end">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Save Profile
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Content Preferences -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-magic me-2"></i>Content Preferences</h5>
                </div>
                <div class="card-body">
                    <form id="contentForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Primary Direction</label>
                                <select class="form-select" id="primaryDirection">
                                    <option value="business_finance">Business & Finance</option>
                                    <option value="technology">Technology</option>
                                    <option value="health_wellness">Health & Wellness</option>
                                    <option value="education">Education</option>
                                    <option value="entertainment">Entertainment</option>
                                    <option value="travel_tourism">Travel & Tourism</option>
                                    <option value="food_cooking">Food & Cooking</option>
                                    <option value="fashion_beauty">Fashion & Beauty</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Default Tone</label>
                                <select class="form-select" id="defaultTone">
                                    <option value="professional">Professional</option>
                                    <option value="casual">Casual</option>
                                    <option value="inspirational">Inspirational</option>
                                    <option value="educational">Educational</option>
                                    <option value="humorous">Humorous</option>
                                    <option value="serious">Serious</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Secondary Directions</label>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="technology" id="secTech" checked>
                                        <label class="form-check-label" for="secTech">Technology</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="health_wellness" id="secHealth">
                                        <label class="form-check-label" for="secHealth">Health & Wellness</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="education" id="secEducation">
                                        <label class="form-check-label" for="secEducation">Education</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="entertainment" id="secEntertainment">
                                        <label class="form-check-label" for="secEntertainment">Entertainment</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="travel_tourism" id="secTravel">
                                        <label class="form-check-label" for="secTravel">Travel & Tourism</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="food_cooking" id="secFood">
                                        <label class="form-check-label" for="secFood">Food & Cooking</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Preferred Content Types</label>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="linkedin" id="prefLinkedIn" checked>
                                        <label class="form-check-label" for="prefLinkedIn">LinkedIn</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="twitter" id="prefTwitter" checked>
                                        <label class="form-check-label" for="prefTwitter">Twitter</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="facebook" id="prefFacebook">
                                        <label class="form-check-label" for="prefFacebook">Facebook</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="instagram" id="prefInstagram">
                                        <label class="form-check-label" for="prefInstagram">Instagram</label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="youtube" id="prefYouTube">
                                        <label class="form-check-label" for="prefYouTube">YouTube</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="blog" id="prefBlog">
                                        <label class="form-check-label" for="prefBlog">Blog</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Favorite Sources</label>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="news" id="sourceNews" checked>
                                        <label class="form-check-label" for="sourceNews">News</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="books" id="sourceBooks" checked>
                                        <label class="form-check-label" for="sourceBooks">Books</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="research" id="sourceResearch">
                                        <label class="form-check-label" for="sourceResearch">Research</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="podcasts" id="sourcePodcasts">
                                        <label class="form-check-label" for="sourcePodcasts">Podcasts</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="videos" id="sourceVideos">
                                        <label class="form-check-label" for="sourceVideos">Videos</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="threads" id="sourceThreads">
                                        <label class="form-check-label" for="sourceThreads">Threads</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-end">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Save Preferences
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Social Media Account Management -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-share-alt me-2"></i>Social Media Account Management</h5>
                    <button class="btn btn-sm btn-outline-primary" onclick="refreshAccountStatus()">
                        <i class="fas fa-sync-alt me-1"></i>Refresh Status
                    </button>
                </div>
                <div class="card-body">
                    <!-- LinkedIn Account -->
                    <div class="row mb-4 p-3 border rounded">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fab fa-linkedin text-primary me-2 fa-lg"></i>
                                <span class="fw-bold me-2">LinkedIn</span>
                                <span class="badge bg-success">Connected</span>
                            </div>
                            <div class="small text-muted mb-2">
                                <strong>Account:</strong> John Doe (Personal)<br>
                                <strong>Last Sync:</strong> 2 hours ago<br>
                                <strong>Permissions:</strong> Read & Write
                            </div>
                            <div class="small">
                                <span class="badge bg-info me-1">Personal Profile</span>
                                <span class="badge bg-secondary me-1">Company Page</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="d-grid gap-2">
                                <button class="btn btn-sm btn-outline-primary" onclick="manageLinkedInAccount()">
                                    <i class="fas fa-cog me-1"></i>Manage
                                </button>
                                <button class="btn btn-sm btn-outline-danger" onclick="disconnectAccount('linkedin')">
                                    <i class="fas fa-unlink me-1"></i>Disconnect
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Facebook Account -->
                    <div class="row mb-4 p-3 border rounded">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fab fa-facebook text-primary me-2 fa-lg"></i>
                                <span class="fw-bold me-2">Facebook</span>
                                <span class="badge bg-success">Connected</span>
                            </div>
                            <div class="small text-muted mb-2">
                                <strong>Account:</strong> John Doe<br>
                                <strong>Last Sync:</strong> 1 day ago<br>
                                <strong>Permissions:</strong> Read & Write
                            </div>
                            <div class="small">
                                <span class="badge bg-info me-1">Personal Profile</span>
                                <span class="badge bg-secondary me-1">Business Page</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="d-grid gap-2">
                                <button class="btn btn-sm btn-outline-primary" onclick="manageFacebookAccount()">
                                    <i class="fas fa-cog me-1"></i>Manage
                                </button>
                                <button class="btn btn-sm btn-outline-danger" onclick="disconnectAccount('facebook')">
                                    <i class="fas fa-unlink me-1"></i>Disconnect
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Instagram Account -->
                    <div class="row mb-4 p-3 border rounded">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fab fa-instagram text-danger me-2 fa-lg"></i>
                                <span class="fw-bold me-2">Instagram</span>
                                <span class="badge bg-success">Connected</span>
                            </div>
                            <div class="small text-muted mb-2">
                                <strong>Account:</strong> @johndoe<br>
                                <strong>Last Sync:</strong> 3 hours ago<br>
                                <strong>Permissions:</strong> Read & Write
                            </div>
                            <div class="small">
                                <span class="badge bg-info me-1">Personal Account</span>
                                <span class="badge bg-secondary me-1">Business Account</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="d-grid gap-2">
                                <button class="btn btn-sm btn-outline-primary" onclick="manageInstagramAccount()">
                                    <i class="fas fa-cog me-1"></i>Manage
                                </button>
                                <button class="btn btn-sm btn-outline-danger" onclick="disconnectAccount('instagram')">
                                    <i class="fas fa-unlink me-1"></i>Disconnect
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Twitter Account -->
                    <div class="row mb-4 p-3 border rounded">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fab fa-twitter text-info me-2 fa-lg"></i>
                                <span class="fw-bold me-2">Twitter</span>
                                <span class="badge bg-secondary">Not Connected</span>
                            </div>
                            <div class="small text-muted mb-2">
                                <strong>Status:</strong> Ready to connect<br>
                                <strong>Permissions:</strong> Read & Write (upon connection)
                            </div>
                            <div class="small">
                                <span class="text-muted">Connect your Twitter account to start posting</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="d-grid gap-2">
                                <button class="btn btn-sm btn-primary" onclick="connectTwitterAccount()">
                                    <i class="fab fa-twitter me-1"></i>Connect
                                </button>
                                <button class="btn btn-sm btn-outline-secondary" disabled>
                                    <i class="fas fa-cog me-1"></i>Manage
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- YouTube Account -->
                    <div class="row mb-4 p-3 border rounded">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fab fa-youtube text-danger me-2 fa-lg"></i>
                                <span class="fw-bold me-2">YouTube</span>
                                <span class="badge bg-secondary">Not Connected</span>
                            </div>
                            <div class="small text-muted mb-2">
                                <strong>Status:</strong> Ready to connect<br>
                                <strong>Permissions:</strong> Read & Write (upon connection)
                            </div>
                            <div class="small">
                                <span class="text-muted">Connect your YouTube channel to start posting</span>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="d-grid gap-2">
                                <button class="btn btn-sm btn-primary" onclick="connectYouTubeAccount()">
                                    <i class="fab fa-youtube me-1"></i>Connect
                                </button>
                                <button class="btn btn-sm btn-outline-secondary" disabled>
                                    <i class="fas fa-cog me-1"></i>Manage
                                </button>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <!-- Account Settings -->
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-cog me-2"></i>Account Settings</h6>
                            <div class="mb-3">
                                <label class="form-label">Auto-post to connected accounts</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="linkedin" id="autoLinkedIn" checked>
                                    <label class="form-check-label" for="autoLinkedIn">LinkedIn</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="facebook" id="autoFacebook" checked>
                                    <label class="form-check-label" for="autoFacebook">Facebook</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="instagram" id="autoInstagram">
                                    <label class="form-check-label" for="autoInstagram">Instagram</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="twitter" id="autoTwitter">
                                    <label class="form-check-label" for="autoTwitter">Twitter</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="youtube" id="autoYouTube">
                                    <label class="form-check-label" for="autoYouTube">YouTube</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6><i class="fas fa-clock me-2"></i>Posting Schedule</h6>
                            <div class="mb-3">
                                <label class="form-label">Default posting time</label>
                                <input type="time" class="form-control" value="09:00" id="defaultPostTime">
                                <small class="text-muted">Local timezone</small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Posting frequency</label>
                                <select class="form-select" id="postingFrequency">
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="biweekly">Bi-weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Security & Permissions -->
                    <hr>
                    <div class="row">
                        <div class="col-12">
                            <h6><i class="fas fa-shield-alt me-2"></i>Security & Permissions</h6>
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Data Security:</strong> Your social media credentials are encrypted and stored securely. 
                                We only request the minimum permissions needed for posting and analytics.
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewPermissions()">
                                    <i class="fas fa-eye me-1"></i>View Permissions
                                </button>
                                <button class="btn btn-sm btn-outline-secondary" onclick="exportAccountData()">
                                    <i class="fas fa-download me-1"></i>Export Data
                                </button>
                                <button class="btn btn-sm btn-outline-danger" onclick="revokeAllPermissions()">
                                    <i class="fas fa-ban me-1"></i>Revoke All
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Subscription Sidebar -->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-crown me-2"></i>Subscription</h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <i class="fas fa-crown fa-3x text-warning mb-2"></i>
                        <h5>Pro Plan</h5>
                        <h3 class="text-primary">$19/month</h3>
                    </div>
                    
                    <div class="mb-3">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Content Generated</span>
                            <span>67/100</span>
                        </div>
                        <div class="progress mb-3">
                            <div class="progress-bar" style="width: 67%"></div>
                        </div>
                        
                        <div class="d-flex justify-content-between mb-2">
                            <span>Social Media Posts</span>
                            <span>23/50</span>
                        </div>
                        <div class="progress mb-3">
                            <div class="progress-bar" style="width: 46%"></div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button class="btn btn-warning">
                            <i class="fas fa-arrow-up me-2"></i>Upgrade Plan
                        </button>
                        <button class="btn btn-outline-danger">
                            <i class="fas fa-times me-2"></i>Cancel Subscription
                        </button>
                    </div>
                    
                    <hr>
                    
                    <h6>Pro Features</h6>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-check text-success me-2"></i>Unlimited content generation</li>
                        <li><i class="fas fa-check text-success me-2"></i>Advanced AI models</li>
                        <li><i class="fas fa-check text-success me-2"></i>Social media scheduling</li>
                        <li><i class="fas fa-check text-success me-2"></i>Analytics dashboard</li>
                        <li><i class="fas fa-check text-success me-2"></i>Priority support</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Load saved preferences
    loadSavedPreferences();
    
    // Profile form submission
    document.getElementById('profileForm').addEventListener('submit', function(e) {
        e.preventDefault();
        saveProfileSettings();
    });
    
    // Content preferences form submission
    document.getElementById('contentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        saveContentPreferences();
    });
});

function loadSavedPreferences() {
    const preferences = JSON.parse(localStorage.getItem('contentPreferences') || '{}');
    
    // Load primary direction
    if (preferences.primaryDirection) {
        document.getElementById('primaryDirection').value = preferences.primaryDirection;
    }
    
    // Load default tone
    if (preferences.defaultTone) {
        document.getElementById('defaultTone').value = preferences.defaultTone;
    }
    
    // Load secondary directions
    if (preferences.secondaryDirections) {
        preferences.secondaryDirections.forEach(direction => {
            const checkbox = document.getElementById('sec' + direction.charAt(0).toUpperCase() + direction.slice(1));
            if (checkbox) checkbox.checked = true;
        });
    }
    
    // Load preferred content types
    if (preferences.preferredContentTypes) {
        preferences.preferredContentTypes.forEach(type => {
            const checkbox = document.getElementById('pref' + type.charAt(0).toUpperCase() + type.slice(1));
            if (checkbox) checkbox.checked = true;
        });
    }
    
    // Load favorite sources
    if (preferences.favoriteSources) {
        preferences.favoriteSources.forEach(source => {
            const checkbox = document.getElementById('source' + source.charAt(0).toUpperCase() + source.slice(1));
            if (checkbox) checkbox.checked = true;
        });
    }
}

function saveProfileSettings() {
    const profileData = {
        name: document.getElementById('userName').value,
        company: document.getElementById('userCompany').value,
        industry: document.getElementById('userIndustry').value,
        region: document.getElementById('userRegion').value,
        language: document.getElementById('userLanguage').value
    };
    
    localStorage.setItem('userProfile', JSON.stringify(profileData));
    showSuccessMessage('Profile settings saved successfully!');
}

function saveContentPreferences() {
    // Get primary direction and default tone
    const primaryDirection = document.getElementById('primaryDirection').value;
    const defaultTone = document.getElementById('defaultTone').value;
    
    // Get secondary directions
    const secondaryDirections = [];
    document.querySelectorAll('input[id^="sec"]:checked').forEach(checkbox => {
        secondaryDirections.push(checkbox.value);
    });
    
    // Get preferred content types
    const preferredContentTypes = [];
    document.querySelectorAll('input[id^="pref"]:checked').forEach(checkbox => {
        preferredContentTypes.push(checkbox.value);
    });
    
    // Get favorite sources
    const favoriteSources = [];
    document.querySelectorAll('input[id^="source"]:checked').forEach(checkbox => {
        favoriteSources.push(checkbox.value);
    });
    
    // Save preferences
    const preferences = {
        primaryDirection,
        defaultTone,
        secondaryDirections,
        preferredContentTypes,
        favoriteSources,
        lastUpdated: new Date().toISOString()
    };
    
    localStorage.setItem('contentPreferences', JSON.stringify(preferences));
    showSuccessMessage('Content preferences saved successfully! Your preferences will be applied to future content generation.');
}

function showSuccessMessage(message) {
    // Create a temporary success alert
    const alertDiv = document.createElement('div');
    alertDiv.className = 'alert alert-success alert-dismissible fade show position-fixed';
    alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(alertDiv);
    
    // Remove after 3 seconds
    setTimeout(() => {
        if (alertDiv.parentNode) {
            alertDiv.parentNode.removeChild(alertDiv);
        }
    }, 3000);
}

// Social Media Account Management Functions
function refreshAccountStatus() {
    console.log('Refreshing account status...');
    // Simulate API call to refresh account status
    showSuccessMessage('Account status refreshed successfully!');
}

function manageLinkedInAccount() {
    showAccountManagementModal('LinkedIn', {
        accountName: 'John Doe (Personal)',
        permissions: ['Read Profile', 'Write Posts', 'Access Analytics'],
        lastSync: '2 hours ago',
        connectedPages: ['Personal Profile', 'Company Page']
    });
}

function manageFacebookAccount() {
    showAccountManagementModal('Facebook', {
        accountName: 'John Doe',
        permissions: ['Read Profile', 'Write Posts', 'Access Pages'],
        lastSync: '1 day ago',
        connectedPages: ['Personal Profile', 'Business Page']
    });
}

function manageInstagramAccount() {
    showAccountManagementModal('Instagram', {
        accountName: '@johndoe',
        permissions: ['Read Profile', 'Write Posts', 'Access Insights'],
        lastSync: '3 hours ago',
        connectedPages: ['Personal Account', 'Business Account']
    });
}

function connectTwitterAccount() {
    showConnectionModal('Twitter', 'https://twitter.com/oauth/authorize?client_id=your_app_id&redirect_uri=your_redirect_uri&scope=tweet.read,tweet.write,users.read');
}

function connectYouTubeAccount() {
    showConnectionModal('YouTube', 'https://accounts.google.com/oauth/authorize?client_id=your_app_id&redirect_uri=your_redirect_uri&scope=https://www.googleapis.com/auth/youtube.upload');
}

function disconnectAccount(platform) {
    if (confirm(`Are you sure you want to disconnect your ${platform} account? This will remove all permissions and stop auto-posting.`)) {
        console.log(`Disconnecting ${platform} account...`);
        // Simulate API call to disconnect account
        showSuccessMessage(`${platform} account disconnected successfully!`);
        
        // Update UI to show disconnected state
        updateAccountStatus(platform, 'disconnected');
    }
}

function showAccountManagementModal(platform, accountInfo) {
    const modalHtml = `
    <div class="modal fade" id="accountModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fab fa-${platform.toLowerCase()} me-2"></i>${platform} Account Management
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Account Information</h6>
                            <p><strong>Account:</strong> ${accountInfo.accountName}</p>
                            <p><strong>Last Sync:</strong> ${accountInfo.lastSync}</p>
                            <p><strong>Status:</strong> <span class="badge bg-success">Connected</span></p>
                        </div>
                        <div class="col-md-6">
                            <h6>Permissions</h6>
                            <ul class="list-unstyled">
                                ${accountInfo.permissions.map(perm => `<li><i class="fas fa-check text-success me-2"></i>${perm}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Connected Pages</h6>
                            <div class="mb-3">
                                ${accountInfo.connectedPages.map(page => `
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="${page}" id="page_${page.replace(/\s+/g, '_')}" checked>
                                    <label class="form-check-label" for="page_${page.replace(/\s+/g, '_')}">${page}</label>
                                </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Posting Settings</h6>
                            <div class="mb-3">
                                <label class="form-label">Default posting time for ${platform}</label>
                                <input type="time" class="form-control" value="09:00">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Content type preferences</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="text" checked>
                                    <label class="form-check-label">Text posts</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="images" checked>
                                    <label class="form-check-label">Image posts</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="videos">
                                    <label class="form-check-label">Video posts</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="saveAccountSettings('${platform}')">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    `;
    
    // Remove existing modal if any
    const existingModal = document.getElementById('accountModal');
    if (existingModal) {
        existingModal.remove();
    }
    
    // Add modal to body
    document.body.insertAdjacentHTML('beforeend', modalHtml);
    
    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('accountModal'));
    modal.show();
}

function showConnectionModal(platform, authUrl) {
    const modalHtml = `
    <div class="modal fade" id="connectionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fab fa-${platform.toLowerCase()} me-2"></i>Connect ${platform} Account
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <i class="fab fa-${platform.toLowerCase()} fa-3x text-primary mb-3"></i>
                        <h5>Connect your ${platform} account</h5>
                        <p class="text-muted">We'll need permission to post content and access analytics on your behalf.</p>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6>Permissions we'll request:</h6>
                        <ul class="mb-0">
                            <li>Read your profile information</li>
                            <li>Post content on your behalf</li>
                            <li>Access analytics and insights</li>
                        </ul>
                    </div>
                    
                    <div class="d-grid">
                        <a href="${authUrl}" class="btn btn-primary btn-lg" target="_blank">
                            <i class="fab fa-${platform.toLowerCase()} me-2"></i>Connect ${platform} Account
                        </a>
                    </div>
                    
                    <div class="text-center mt-3">
                        <small class="text-muted">
                            You'll be redirected to ${platform} to authorize the connection
                        </small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    `;
    
    // Remove existing modal if any
    const existingModal = document.getElementById('connectionModal');
    if (existingModal) {
        existingModal.remove();
    }
    
    // Add modal to body
    document.body.insertAdjacentHTML('beforeend', modalHtml);
    
    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('connectionModal'));
    modal.show();
}

function saveAccountSettings(platform) {
    console.log(`Saving ${platform} account settings...`);
    // Simulate API call to save settings
    showSuccessMessage(`${platform} account settings saved successfully!`);
    
    // Close modal
    const modal = bootstrap.Modal.getInstance(document.getElementById('accountModal'));
    modal.hide();
}

function updateAccountStatus(platform, status) {
    // Update the UI to reflect the new connection status
    const platformElement = document.querySelector(`[onclick*="${platform}"]`).closest('.row');
    const badge = platformElement.querySelector('.badge');
    const statusText = platformElement.querySelector('.small.text-muted');
    
    if (status === 'disconnected') {
        badge.className = 'badge bg-secondary';
        badge.textContent = 'Not Connected';
        statusText.innerHTML = `<strong>Status:</strong> Ready to connect<br><strong>Permissions:</strong> Read & Write (upon connection)`;
    }
}

function viewPermissions() {
    const permissionsHtml = `
    <div class="modal fade" id="permissionsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-shield-alt me-2"></i>Account Permissions</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>LinkedIn</h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>Read Profile</li>
                                <li><i class="fas fa-check text-success me-2"></i>Write Posts</li>
                                <li><i class="fas fa-check text-success me-2"></i>Access Analytics</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Facebook</h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>Read Profile</li>
                                <li><i class="fas fa-check text-success me-2"></i>Write Posts</li>
                                <li><i class="fas fa-check text-success me-2"></i>Access Pages</li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Instagram</h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i>Read Profile</li>
                                <li><i class="fas fa-check text-success me-2"></i>Write Posts</li>
                                <li><i class="fas fa-check text-success me-2"></i>Access Insights</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Twitter & YouTube</h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-times text-muted me-2"></i>Not connected</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    `;
    
    // Remove existing modal if any
    const existingModal = document.getElementById('permissionsModal');
    if (existingModal) {
        existingModal.remove();
    }
    
    // Add modal to body
    document.body.insertAdjacentHTML('beforeend', permissionsHtml);
    
    // Show modal
    const modal = new bootstrap.Modal(document.getElementById('permissionsModal'));
    modal.show();
}

function exportAccountData() {
    console.log('Exporting account data...');
    // Simulate data export
    showSuccessMessage('Account data exported successfully! Check your downloads.');
}

function revokeAllPermissions() {
    if (confirm('Are you sure you want to revoke all social media permissions? This will disconnect all accounts and stop all auto-posting.')) {
        console.log('Revoking all permissions...');
        // Simulate API call to revoke all permissions
        showSuccessMessage('All permissions revoked successfully!');
        
        // Update all account statuses to disconnected
        ['linkedin', 'facebook', 'instagram', 'twitter', 'youtube'].forEach(platform => {
            updateAccountStatus(platform, 'disconnected');
        });
    }
}
</script>
{% endblock %}
{% endblock %} 